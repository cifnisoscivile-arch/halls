<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª - Ø³ÙŠØ¯ÙŠ Ø¥ÙÙ†ÙŠ</title>
    <style>
        /* Ø¥Ø¶Ø§ÙØ© Ø®Ø· ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„ */
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        
        body { 
            font-family: 'Cairo', sans-serif; 
            background-color: #f0f2f5; 
            text-align: center; 
            padding: 15px; 
            direction: rtl; 
        }
        .container { 
            background: white; 
            max-width: 450px; 
            margin: 20px auto; 
            padding: 25px; 
            border-radius: 15px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.1); 
        }
        h2 { color: #003366; margin-bottom: 25px; }
        input[type="date"] { 
            width: 90%; 
            padding: 12px; 
            margin-bottom: 20px; 
            border: 2px solid #003366; 
            border-radius: 10px; 
            font-size: 16px; 
            font-family: inherit;
        }
        button { 
            width: 95%; 
            padding: 15px; 
            background-color: #003366; 
            color: white; 
            border: none; 
            border-radius: 10px; 
            font-size: 18px; 
            font-weight: bold; 
            cursor: pointer; 
            transition: 0.3s;
        }
        button:hover { background-color: #00509e; }
        .hall-card { 
            background: #fff; 
            border: 1px solid #eee; 
            padding: 15px; 
            margin-top: 15px; 
            border-radius: 12px; 
            text-align: right; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .status-busy { color: #d32f2f; font-weight: bold; }
        .status-free { color: #2e7d32; font-weight: bold; }
        .details { font-size: 0.9em; color: #666; margin-top: 5px; display: block; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“± Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</h2>
    <input type="date" id="searchDate" onchange="checkStatus()">
    <button onclick="checkStatus()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¢Ù† ğŸ”„</button>
    <div id="resultsList"></div>
</div>

<script>
    // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„Ù„ÙŠÙˆÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    document.getElementById('searchDate').valueAsDate = new Date();

    async function checkStatus() {
        const targetDate = document.getElementById('searchDate').value;
        const listDiv = document.getElementById('resultsList');
        listDiv.innerHTML = "<p>Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>";

        // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØµØ­ÙŠØ­ Ù„Ø³ÙŠØ±ÙØ± Ø£ÙˆØ±ÙˆØ¨Ø§ ÙƒÙ…Ø§ ÙÙŠ ØµÙˆØ±ØªÙƒ
        const url = "https://hallsystem-e74c7-default-rtdb.europe-west1.firebasedatabase.app/halls_status.json";

        try {
            const response = await fetch(url);
            const data = await response.json();
            
            // Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ù†Ø¸Ø§Ù…Ùƒ
            const myHalls = ["Ù‚Ø§Ø¹Ø© Ø£ÙÙŠÙ†Ø¯Ø§", "Ù‚Ø§Ø¹Ø© Ø§Ù„Ù…Ø³ÙŠØ±Ø© Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡"];
            let htmlContent = "";

            myHalls.forEach(hallName => {
                let booking = null;
                if (data) {
                    for (let id in data) {
                        let r = data[id];
                        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø¹Ø© ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®
                        if (r.hall === hallName && targetDate >= r.start && targetDate <= r.end) {
                            booking = r;
                            break;
                        }
                    }
                }

                if (booking) {
                    htmlContent += `
                        <div class="hall-card" style="border-right: 8px solid #d32f2f;">
                            <div>
                                <strong>${hallName}</strong>
                                <span class="details">Ø§Ù„Ø¬Ù‡Ø©: ${booking.org}</span>
                            </div>
                            <span class="status-busy">ğŸ”´ Ù…Ø­Ø¬ÙˆØ²Ø©</span>
                        </div>`;
                } else {
                    htmlContent += `
                        <div class="hall-card" style="border-right: 8px solid #2e7d32;">
                            <div>
                                <strong>${hallName}</strong>
                                <span class="details">Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</span>
                            </div>
                            <span class="status-free">ğŸŸ¢ Ø´Ø§ØºØ±Ø©</span>
                        </div>`;
                }
            });

            listDiv.innerHTML = htmlContent;

        } catch (e) {
            listDiv.innerHTML = "<p style='color:red;'>âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>";
        }
    }

    // Ø§Ù„ÙØ­Øµ ÙÙˆØ± ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    checkStatus();
</script>

</body>
</html>
